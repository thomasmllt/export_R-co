{
  // ===============================================
  // Dev Container pour le projet R-co
  // - Environnement Python 3.13 (Debian trixie)
  // - Node 20 pour les outils front (ESLint/Prettier/Stylelint/HTMLHint)
  // - Port 5000 exposé (Flask)
  // ===============================================
  "name": "R-co (Python 3.13)",

  // Image de base
  "image": "mcr.microsoft.com/devcontainers/python:3.13-trixie",

  // Ajout d'outils côté conteneur (git, zsh, node 20, etc.)
  "features": {
    "ghcr.io/devcontainers/features/common-utils:2": {},
    "ghcr.io/devcontainers/features/node:1": { "version": "20" }
  },

  // Extensions VS Code installées DANS le conteneur (pour standardiser)
  "customizations": {
    "vscode": {
      "extensions": [
        // Python
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-python.black-formatter",

        // Docker / Dev Containers
        "ms-azuretools.vscode-docker",
        "ms-vscode-remote.remote-containers",

        // YAML / OpenAPI
        "redhat.vscode-yaml",
        "42CRUNCH.vscode-openapi",

        // Web (HTML/CSS/JS)
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "stylelint.vscode-stylelint",
        "ecmel.vscode-html-css",
        "naumovs.color-highlight",

        // Collaboration
        "ms-vsliveshare.vsliveshare"

      ],
      "settings": {
        // Formatage automatique
        "editor.formatOnSave": false,
        "files.trimFinalNewlines": true,
        "files.insertFinalNewline": true,
        "files.trimTrailingWhitespace": true,

        // Python formaté par Black
        "[python]": { "editor.defaultFormatter": "ms-python.black-formatter" },

        // Formatage front par Prettier
        "[javascript]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },
        "[typescript]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },
        "[json]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },
        "[jsonc]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },
        "[markdown]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },
        "[yaml]": { "editor.defaultFormatter": "esbenp.prettier-vscode" },

        // Auto-fix ESLint / Stylelint si possible
        "eslint.format.enable": true,
        "editor.codeActionsOnSave": {
          "source.fixAll.eslint": true,
          "source.fixAll.stylelint": true
        }
      }
    }
  },

  // Après création du conteneur : installer linters/formatters côté container
  "postCreateCommand": "bash -lc 'python -m pip install --upgrade pip && pip install flask black ruff isort && if [ ! -f package.json ]; then npm init -y >/dev/null 2>&1; fi && npm i -D eslint prettier stylelint stylelint-config-standard htmlhint >/dev/null 2>&1 && echo Done'",

  // Expose le port Flask
  "forwardPorts": [5000],
  "portsAttributes": { "5000": { "label": "Flask (dev)" } },

  // Utilisateur du conteneur
  "remoteUser": "vscode"
}
